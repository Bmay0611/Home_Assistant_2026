script:
  speak_on_sonos:
    alias: Speak on Sonos
    mode: queued
    fields:
      message:
        description: Text to speak
        example: "Hello from Sonos"
    sequence:
      - variables:
          msg: >-
            {% set m = message | default('') %}
            {% if m | trim | length > 0 %}
              {{ m }}
            {% else %}
              Sonos speech test.
            {% endif %}
      - service: tts.speak
        target:
          entity_id: tts.home_assistant_cloud
        data:
          media_player_entity_id: media_player.living_room
          message: "{{ msg }}"
